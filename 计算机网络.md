# 自顶向下之——计算机网络

计算机网络是前端工程师不可或缺的一项技能。这里涉及到OSI七层模型，TCP五层模型等。本小册借鉴与整理了图解计算机网络系列并针对前端工程师常见面试题进行了知识输出。

## OSI七层模型

概念：**开放式系统互联模型**（英语：Open System Interconnection Model，缩写：OSI；简称为OSI模型）是一种[概念模型](https://zh.wikipedia.org/wiki/概念模型)，由[国际标准化组织](https://zh.wikipedia.org/wiki/国际标准化组织)提出，一个试图使各种计算机在世界范围内互连为网络的标准框架。

该模型将通信系统中的数据流划分为七个层，从跨通信介质传输位的物理实现到分布式应用程序数据的最高层表示。每个中间层为其上一层提供功能，其自身功能则由其下一层提供。功能的类别通过标准的通信协议在软件中实现。

![aHR0cDovL2hpLmNzZG4ubmV0L2F0dGFjaG1lbnQvMjAxMjAxLzUvMF8xMzI1NzQ0NTk3V00zMi5naWY](https://gitee.com/krialy/images/raw/master/source/20210302163252.gif)



## TCP/IP分层管理

TCP/IP协议族按照层次分别分为这几个层次：应用层、传输层、网络层和数据链路层。

##### 为什么要对网络协议族分层？

它的思想就是可拓展与维护性强，如果我们想要替换某个协议，我们只需要修改与替换修改该协议对应的层次即可，修改成本低，且出现bug的概率也会显著降低。如果将所有协议封装成了一层次，如果需要替换其中一个协议，它的影响范围会很大，需要修改整个层次。

这就好比软件工程中的职责单一的原则。职责单一会让我们的软件拓展性更强，维护性更好。

##### 它与OSI七层模型的区别？

20世纪90年代，ISO开展了OSI这一国际标准协议的标准化进程，然而，OSI协议并没有得到普及，真正被广泛使用的是TCP/IP协议。OSI参考模型注重“通信协议必要的功能是什么”，而TCP/IP更强调“在计算机上实现协议应该开发哪种程序”；虽然OSI并未被得到普及，但是TCP/IP的各种协议其实也能对应到OSI参考模型当中，清楚这些协议分属于OSI的哪一层，就能对该协议的目的有所了解。下面是各个协议与OSI参考模型中各个分层之间的对应关系。

![image-20210302164642411](https://gitee.com/krialy/images/raw/master/source/20210302164643.png)

## 应用层协议之——什么是HTTP

HTTP又叫超文本传输协议，**协议**产生的最初原因就是为了解决传输的一致性，如果没有协议，客户端与服务端是无法交流的，这就好比两国人，如果没有语言这个协议，也是无法沟通的。

##### 为什么会有HTTPS？

首先我们看下HTTP的不足：

1. 通信使用明文，内容可能会抓取窃听。
2. 不验证通信方的身份，因此很有可能会被伪装。
3. 无法证明报文的正确性与完整性，内容很有可能会被修改。

![image-20210302155043402](https://gitee.com/krialy/images/raw/master/source/20210302155044.png)

现在，要如何解决这些问题呢？

**传统加密方案**：采用密钥的方式进行加密解密（共享密钥法）。

显然，这种方案在http加密中是不够有效的，因为在通信的时候需要把密钥传给需要发送的目标，然而发送的过程中，中途是很有可能出现密钥被第三方截取的可能。

**方案二**：使用HTTPS

HTTPS = HTTP + 加密+认证+完整性保护，因为HTTP本身是没有加密机制的，所以需要借助其他协议来进行加密。

HTTPS是身披了SSL外壳的HTTP，它并非是新的应用层协议，仅仅是协议的组合。

![image-20210302155014003](https://gitee.com/krialy/images/raw/master/source/20210302155015.png)

下面讲解SSL的加密方式（公开密钥加密方式）：

SSL使用了一种非对称的密钥：一包叫做密钥（private key），另外一把叫做公钥（public key）。

这里举个例子：小王、小明和小红三者进行通讯。

小王：一把自己的密钥；一把小明的公钥；一把小红的公钥

小明：一把自己的密钥；一把小王的公钥；一把小红的公钥；

小红：一把自己的密钥；一把小王的公钥；一把小明的公钥；

现在小王和小红通讯，小红发送了一条信息并且通过小王的公钥进行加密，小王收到后用自己的密钥解密即可。这里即使小红的信件被截取了，别人也无法解密，因为只能通过小王的密钥才可以解密。除非小王自己弄丢了自己的密钥。（如果小王想发送讯息给小红，使用小红的公钥对讯息加密然后发送给小红即可）

这里还存在一个问题，如果小红的公钥并不是小王的公钥该怎么办？如果小明偷偷把自己的公钥和小红的公钥交换了，那么小明就能伪造小王来与小红通讯了！

那么该如何解决？

使用数字证书认证机构（CA）和其他相关机关颁发的公开密钥技术。CA机构能够保证小红拿到的公钥是小王的公钥。

![image-20210302165140542](https://gitee.com/krialy/images/raw/master/source/20210302165142.png)

## 会话层协议之——DNS

##### 为什么会出现DNS协议？

我们都知道IP地址是一串无任何意义的代码，非常不便与记忆，而且很多时候IP地址都非常长，这更加导致了IP地址难于记忆。

为了解决这个难题，可以使用主机识别码，也就是hosts文件来建立相应的映射，hosts文件由一个互联网信息中心管理派发，从而不用每次都输入冗长的IP地址了。但是，它存在一个问题，如果互联网中心的hosts文件出现了变更，需要其他计算机同步hosts文件网络才能正常访问，否则会存在映射到不相干的IP地址的情况。

![image-20210302171205720](https://gitee.com/krialy/images/raw/master/source/20210302171207.png)

##### 因此，DNS诞生了

DNS维护了一个用来表示组织内部主机名和IP地址对应关系的数据库。当用户输入主机名（域名）时，DNS会自动检索那个注册了主机名和IP地址的数据库，并迅速定位对应的IP地址。并且如果主机名和IP的映射有变更时，我们也不需要让所有个体计算机或者机构报告了，只需要在内部进行处理即可。

##### DNS的查询机制



##### CDN是什么？





## 传输层协议之——TCP与UDP



##### 什么是TCP？

